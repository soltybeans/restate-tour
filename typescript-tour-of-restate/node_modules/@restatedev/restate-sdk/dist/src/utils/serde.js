"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
exports.deserializeNoop = exports.serializeNoop = exports.deserializeJson = exports.serializeJson = void 0;
const node_buffer_1 = require("node:buffer");
const errors_1 = require("../types/errors");
/* eslint-disable @typescript-eslint/no-explicit-any */
function serializeJson(item) {
    if (item === undefined) {
        return node_buffer_1.Buffer.alloc(0);
    }
    try {
        const str = JSON.stringify(item);
        return node_buffer_1.Buffer.from(str);
    }
    catch (e) {
        throw new errors_1.TerminalError(`Failed to serialize JSON: ${e}`);
    }
}
exports.serializeJson = serializeJson;
/* eslint-disable @typescript-eslint/no-explicit-any */
function deserializeJson(buf) {
    if (buf.length === 0) {
        return undefined;
    }
    const b = node_buffer_1.Buffer.from(buf);
    const str = b.toString("utf8");
    try {
        return JSON.parse(str);
    }
    catch (e) {
        throw new errors_1.TerminalError(`Failed to parse JSON: ${e}`);
    }
}
exports.deserializeJson = deserializeJson;
/* eslint-disable @typescript-eslint/no-explicit-any */
function serializeNoop(item) {
    if (!(item instanceof Uint8Array)) {
        throw new errors_1.TerminalError(`Return value must be an instance of a Uint8Array`);
    }
    return item;
}
exports.serializeNoop = serializeNoop;
/* eslint-disable @typescript-eslint/no-explicit-any */
function deserializeNoop(buf) {
    return buf;
}
exports.deserializeNoop = deserializeNoop;
//# sourceMappingURL=serde.js.map